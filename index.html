<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vatech CT ROI ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>

<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
<div id="root"></div>

<script type="text/babel">

const { useState, useMemo } = React;
const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Cell, ResponsiveContainer } = Recharts;

const currency = (v) => `Â¥${Math.round(v).toLocaleString()}`;

/* ğŸ”¥ Safari ì•ˆì • ìˆ«ì ì²˜ë¦¬ í•¨ìˆ˜ */
const handleNumeric = (value, setter) => {
    const cleaned = value.replace(/[^0-9]/g, "");
    setter(Number(cleaned) || 0);
};

function Input({ value, setValue, placeholder }) {
    return (
        <input
            type="text"
            inputMode="numeric"
            value={value}
            placeholder={placeholder}
            onChange={(e) => handleNumeric(e.target.value, setValue)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"
        />
    );
}

function DentalCTROICalculator() {

const WARRANTY_MONTHS = 120;

const [equipmentPrice, setEquipmentPrice] = useState(7680000);

const [income, setIncome] = useState({
    pano: { fee:1500, perDay:3, days:22 },
    ctIns: { fee:3500, perDay:2, days:22 },
    ctSelf:{ fee:15000, perDay:1, days:22 },
    ceph:{ fee:2000, perDay:1, days:22 },
    other:0
});

const [cost, setCost] = useState({
    maintenance:30000,
    consumables:20000,
    electricity:15000,
    rent:200000,
    rentRatio:30,
    doctor:800000,
    doctorRatio:10,
    staff:300000,
    staffRatio:20,
    other:0
});

const monthlyIncome = useMemo(()=>{
    const calc = i=>i.fee*i.perDay*i.days;
    const pano=calc(income.pano);
    const ctIns=calc(income.ctIns);
    const ctSelf=calc(income.ctSelf);
    const ceph=calc(income.ceph);
    const total=pano+ctIns+ctSelf+ceph+income.other;
    return {total};
},[income]);

const monthlyCost = useMemo(()=>{
    const rent=cost.rent*(cost.rentRatio/100);
    const doctor=cost.doctor*(cost.doctorRatio/100);
    const staff=cost.staff*(cost.staffRatio/100);
    const total=
        cost.maintenance+
        cost.consumables+
        cost.electricity+
        rent+doctor+staff+
        cost.other;
    return {total};
},[cost]);

const net=monthlyIncome.total-monthlyCost.total;
const payback=net>0?Math.ceil(equipmentPrice/net):0;
const netProfit=net*(WARRANTY_MONTHS-payback);

const chartData=[
    {name:"åå…¥",value:monthlyIncome.total},
    {name:"è²»ç”¨",value:monthlyCost.total},
    {name:"ç´”åˆ©ç›Š",value:net}
];

return (
<div className="min-h-screen bg-gray-50 p-6">
<div className="max-w-7xl mx-auto space-y-6">

<h1 className="text-3xl font-bold">Vatech CT ROI ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>

<div className="grid md:grid-cols-3 gap-4">
<div className="bg-white p-4 rounded shadow">
<p className="text-sm text-gray-500">æœˆé–“ç´”åˆ©ç›Š</p>
<p className="text-2xl font-bold text-red-600">{currency(net)}</p>
</div>
<div className="bg-white p-4 rounded shadow">
<p className="text-sm text-gray-500">æŠ•è³‡å›åæœŸé–“</p>
<p className="text-2xl font-bold">{payback} ãƒ¶æœˆ</p>
</div>
<div className="bg-white p-4 rounded shadow">
<p className="text-sm text-gray-500">ãƒ¯ãƒ©ãƒ³ãƒ†ã‚£å†…ç´”åˆ©ç›Š</p>
<p className="text-2xl font-bold">{currency(netProfit)}</p>
</div>
</div>

<div className="grid xl:grid-cols-3 gap-6">

<div className="bg-white p-5 rounded shadow space-y-3">
<h2 className="font-semibold">CTè£…ç½®ä¾¡æ ¼</h2>
<Input value={equipmentPrice} setValue={setEquipmentPrice}/>
</div>

<div className="bg-white p-5 rounded shadow space-y-3">
<h2 className="font-semibold">æœˆé–“è²»ç”¨</h2>
<Input value={cost.maintenance} setValue={(v)=>setCost({...cost,maintenance:v})}/>
<Input value={cost.consumables} setValue={(v)=>setCost({...cost,consumables:v})}/>
<Input value={cost.electricity} setValue={(v)=>setCost({...cost,electricity:v})}/>
</div>

<div className="bg-white p-5 rounded shadow">
<ResponsiveContainer width="100%" height={240}>
<BarChart data={chartData}>
<CartesianGrid strokeDasharray="3 3"/>
<XAxis dataKey="name"/>
<YAxis/>
<Tooltip formatter={(v)=>currency(v)}/>
<Bar dataKey="value">
{chartData.map((e,i)=>
<Cell key={i} fill={i===2?"#dc2626":"#9ca3af"}/>
)}
</Bar>
</BarChart>
</ResponsiveContainer>
</div>

</div>
</div>
</div>
);
}

const root=ReactDOM.createRoot(document.getElementById("root"));
root.render(<DentalCTROICalculator/>);

</script>
</body>
</html>




